plot_harmony <- function(x,home,columns,home_chord=NULL,unlist=FALSE,name=NULL,title=NULL) {
  checkmate::assert(checkmate::check_integer(x),checkmate::check_list(x,types="integerish"))
  checkmate::assert_choice(home,c(0,12))
  checkmate::qassert(columns,"S2")
  if (unlist) {x = x %>% unlist}
  h = x %>% purrr::map(harmony,home,name,home_chord) %>% purrr::map_dfr(.f=dplyr::bind_rows)
  plot(h[,columns],main=title)
  text(h[,columns],labels=h$intervallic_name,pos=1)
  TRUE
}

theme_homey <- function(){
  brown = '#664433'
  cream = '#F3DDAB'

  font <- "Helvetica"   #assign font family up front

  ggplot2::theme_minimal()

  ggplot2::`%+replace%`  #replace elements we want to change

  ggplot2::theme(
    # text = ggplot2::element_text(size = 5),
    plot.title = ggplot2::element_text(color=cream),
    axis.title = ggplot2::element_text(color=cream),
    axis.text = ggplot2::element_text(color=cream),
    axis.ticks = ggplot2::element_blank(),
    plot.background = ggplot2::element_rect(fill = brown),
    panel.background = ggplot2::element_rect(fill = brown),
    panel.grid.major = ggplot2::element_line(color = cream, size=0.2),
    panel.grid.minor = ggplot2::element_line(color = cream, size=0.05, linetype ="dashed")
  )
}
